<div class="container mt-4">

    <div class="row">
        <div class="col-12">
            <mat-accordion>
                <mat-expansion-panel class="mt-2">
                    <mat-expansion-panel-header>
                        <mat-panel-title>Филтри</mat-panel-title>
                    </mat-expansion-panel-header>

                    <div class="row mt-3">
                        <div class="col-lg-4 col-md-6 col-sm-12 mb-3">
                            <mat-form-field appearance="outline" class="w-100">
                                <mat-label>Пребарај по наслов</mat-label>
                                <input matInput placeholder="Внеси наслов" [ngModel]="searchTerm()"
                                    (ngModelChange)="searchBySearchTerm($event)" />
                                <mat-icon matSuffix>search</mat-icon>
                            </mat-form-field>
                        </div>

                        <div class="col-lg-4 col-md-6 col-sm-12 mb-3">
                            <mat-form-field appearance="outline" class="w-100">
                                <mat-label>Приоритет</mat-label>
                                <mat-select [(ngModel)]="selectedPriority" (selectionChange)="applyFilters()">
                                    <mat-option [value]="">Сите</mat-option>
                                    <mat-option [value]="1">Низок</mat-option>
                                    <mat-option [value]="2">Среден</mat-option>
                                    <mat-option [value]="3">Висок</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-lg-4 col-md-6 col-sm-12 mb-3">
                            <mat-form-field appearance="outline" class="w-100">
                                <mat-label>Членови</mat-label>
                                <mat-select [(ngModel)]="toMemberId" (selectionChange)="applyFilters()">
                                    <mat-option *ngFor="let member of clubMembers" [value]="member.id">
                                        {{ member.name }}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                        <div class="col-lg-4 col-md-6 col-sm-12 mb-3 d-flex align-items-center">
                            <button mat-button color="primary" (click)="resetFilters()">Ресетирај
                                филтри</button>
                        </div>
                    </div>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
    </div>
    <!-- @for (notee of notes(); track $index) {
    <div class="col-md-6 col-lg-4">
        <app-note [note]="notee"></app-note>
    </div>
    } -->

    <div class="row">
        <div class="desktop-only">
            <div class="d-flex justify-content-center">
                <div class="table-responsive w-100" style="max-height: 600px;">
                    <div class="table-wrapper">
                        <div class="table-title">
                            <div class="row">
                                <div class="col-sm-5">
                                    <h2><b>Белешки</b></h2>
                                </div>
                                <div class="col-sm-7 text-end">
                                    <button mat-raised-button color="accent" (click)="openAddNoteDialog()">
                                        <mat-icon>add</mat-icon> Додади белешка
                                    </button>

                                </div>
                            </div>
                        </div>
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Наслов</th>
                                    <th>Опис</th>
                                    <th>За</th>
                                    <th>Датум</th>
                                    <th>Приоритет</th>
                                    <th>Акции</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if(notes()!=null){
                                <tr *ngFor="let note of notes(); let i = index">
                                    <td>{{ i + 1 }}</td>

                                    <td>{{ note.title }}</td>
                                    <td data-bs-toggle="tooltip" class="tooltip-cell" title="{{ note.content }}">{{
                                        truncateContent(note.content)}}</td>
                                    <td>
                                        {{ note.toMemberFullName }}
                                    </td>
                                    <td>{{ note.createdAt| date: 'dd/MM/yyyy' }}</td>
                                    <td>{{ mapPriority(note.priority)}}</td>


                                    <td>

                                        <a (click)="onDeleteNote(+note.id)" style="cursor: pointer;" class="delete"
                                            title="Delete" data-toggle="tooltip">
                                            <i class="material-icons">&#xE5C9;</i>
                                        </a>
                                    </td>
                                </tr>

                                }@else {
                                <div class="d-flex justify-content-center w-100">
                                    Spinner here
                                </div>
                                }

                            </tbody>
                        </table>
                        <mat-paginator class="table-paginator" [length]="totalNotes" [pageSize]="pageSize"
                            [pageSizeOptions]="pageSizeOptions" (page)="onPageChange($event)">
                        </mat-paginator>

                    </div>
                </div>
            </div>
        </div>

    </div>